/*!
 * Galpop Image Gallery Popup
 * http://galpop.magicmediamuse.com/
 *
 * Author
 * Richard Hung
 * http://www.magicmediamuse.com/
 *
 * Version
 * 1.0.5
 *
 * Copyright (c) 2014 Richard Hung.
 *
 * License
 * Galpop Image Gallery Popup by Richard Hung is licensed under a Creative Commons Attribution-NonCommercial 3.0 Unported License.
 * http://creativecommons.org/licenses/by-nc/3.0/deed.en_US
 */

!function(t){"use strict";var o={arrowKeys:!0,controls:!0,loop:!0,maxWidth:null,maxHeight:null,maxScreen:90,updateRsz:!0,callback:null,lockScroll:!0},a={init:function(o){return this.click(function(a){t(this).galpop("openBox",o),a.preventDefault()})},openBox:function(a,n){a=t.extend({},o,a),e.data({controls:a.controls,loop:a.loop,maxWidth:a.maxWidth,maxHeight:a.maxHeight,maxScreen:a.maxScreen,callback:a.callback});var i="",p=this,l=0;return n||(n=this.attr("href"),i=this.data("galpop-group"),p=t('[data-galpop-group="'+i+'"]'),l=p.index(this),a.arrowKeys&&t(document).on("keydown",s),a.updateRsz&&t(window).resize(u),a.lockScroll&&t("html").addClass("lock-scroll")),e.data({rel:i,group:p,index:l,status:!0,count:p.length}),e.fadeIn(500,"swing"),this.galpop("preload",n),this},closeBox:function(){e.removeClass("complete").fadeOut(500,"swing",function(){p.find("img").remove(),l.hide().contents().remove(),t(this).data("status",!1),r.hide(),d.hide(),t(document).off("keydown",s),t(window).off("resize",u),t("html").removeClass("lock-scroll")})},preload:function(t){return g=new Image,g.src=t,g.onload=function(){e.galpop("display")},g.onerror=function(){console.log(t+" contains a broken image!")},this},display:function(){var o=g.height,a=g.width,i=e.data("maxWidth"),l=e.data("maxHeight"),r=e.data("maxScreen"),d=t(window).height(),c=t(window).width(),s=0;(!i||i>c*r/100)&&(i=c*r/100),(!l||l>d*r/100)&&(l=d*r/100),a>i&&(s=i/a,o*=s,a*=s),o>l&&(s=l/o,a*=s,o*=s),n.css({height:o,width:a}),setTimeout(function(){e.addClass("complete"),p.append(g).find("img").height(o).width(a).fadeIn(500,"swing",function(){e.galpop("complete")})},500)},complete:function(){var o=e.data("controls"),a=e.data("callback"),n=e.data("index"),i=e.data("count"),p=e.data("loop");e.galpop("infoParse"),!o||0===n&&!p||1>=i?r.hide():r.show(),!o||n+1>=i&&!p||1>=i?d.hide():d.show(),t.isFunction(a)&&a.call(this)},moveItem:function(o){var a=e.data("group"),n=!1,i="";return e.removeClass("complete"),l.fadeOut(500,"swing",function(){t(this).contents().remove()}),p.find("img").fadeOut(500,"swing",function(){t(this).remove(),n=a.eq(o),i=n.attr("href"),n.galpop("preload",i),e.data("index",o)}),this},next:function(){var t=e.data("index"),o=e.data("loop"),a=e.data("count");return a>t+1?(t++,e.galpop("moveItem",t)):o&&(t=0,e.galpop("moveItem",t)),this},prev:function(){var t=e.data("index"),o=e.data("loop"),a=e.data("count");return t>0?(t--,e.galpop("moveItem",t)):o&&(t=a-1,e.galpop("moveItem",t)),this},infoParse:function(){var o=e.data("index"),a=e.data("group"),n=a.eq(o),i=t.trim(n.attr("title")),p=t.trim(n.data("galpop-link")),r=t.trim(n.data("galpop-link-title")),d=t.trim(n.data("galpop-link-target"));l.html(""),""!==i&&t("<p>"+i+"</p>").appendTo(l),""!==p&&(""===r&&(r=p),""!==d&&(d='target="'+d+'"'),t('<p><a href="'+p+'" '+d+">"+r+"</a></p>").appendTo(l)),(""!==i||""!==p)&&l.fadeIn(500,"swing")},update:function(){var t=e.data("index");return e.galpop("moveItem",t),this},destroy:function(){return this.off("click")}};t.fn.galpop=function(o){return a[o]?a[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on jQuery.galpop"):a.init.apply(this,arguments)};var e,n,i,p,l,r,d,c,s,u,g;t(document).ready(function(){e=t('<div id="galpop-wrapper" />').prependTo("body"),n=t('<div id="galpop-container" />').appendTo(e),r=t('<a href="#" id="galpop-prev" />').appendTo(n),d=t('<a href="#" id="galpop-next" />').appendTo(n),i=t('<div id="galpop-ajax" />').appendTo(n),p=t('<div id="galpop-content" />').appendTo(n),l=t('<div id="galpop-info" />').appendTo(p),c=t('<a href="#" id="galpop-close" />').appendTo(p),e.click(function(o){t(this).galpop("closeBox"),o.preventDefault()}),n.click(function(t){t.stopPropagation()}),r.hide().click(function(t){e.galpop("prev"),t.preventDefault()}),d.hide().click(function(t){e.galpop("next"),t.preventDefault()}),c.click(function(t){e.galpop("closeBox"),t.preventDefault()}),l.on("click","a",function(){e.galpop("closeBox")}),s=function(t){var o=t.which,a=!1;switch(o){case 27:e.galpop("closeBox"),a=!0;break;case 37:e.galpop("prev"),a=!0;break;case 39:e.galpop("next"),a=!0}a&&t.preventDefault()},u=function(){e.galpop("update")}})}(jQuery);
