/**
 * Galpop Image Gallery Popup
 * http://galpop.magicmediamuse.com/
 *
 * Author
 * Richard Hung
 * http://www.magicmediamuse.com/
 *
 * Version
 * 1.0.3
 * 
 * Copyright (c) 2014 Richard Hung.
 * 
 * License
 * Galpop Image Gallery Popup by Richard Hung is licensed under a Creative Commons Attribution-NonCommercial 3.0 Unported License.
 * http://creativecommons.org/licenses/by-nc/3.0/deed.en_US
 */

!function(a){"use strict";var t={init:function(t){var e={arrowKeys:!0,controls:!0,loop:!0,maxWidth:null,maxHeight:null,maxScreen:90,updateRsz:!0,callback:null,lockScroll:!0};return t=a.extend({},e,t),this.click(function(e){o.data({arrowKeys:t.arrowKeys,controls:t.controls,loop:t.loop,maxWidth:t.maxWidth,maxHeight:t.maxHeight,maxScreen:t.maxScreen,updateRsz:t.updateRsz,callback:t.callback,lockScroll:t.lockScroll}),a(this).galpop("openBox"),e.preventDefault()})},openBox:function(){var t=this.data("galpop-group"),e=a('[data-galpop-group="'+t+'"]'),n=e.index(this),i=o.data("arrowKeys"),p=o.data("updateRsz"),l=o.data("lockScroll");return i&&a(document).bind("keydown",c),p&&a(window).resize(s),l&&a("html").addClass("lock-scroll"),o.fadeIn(500,"swing"),o.data({rel:t,group:e,index:n,status:!0,count:e.length}),this.galpop("preload"),this},closeBox:function(){o.removeClass("complete").fadeOut(500,"swing",function(){i.find("img").remove(),p.hide().contents().remove(),a(this).data("status",!1),l.hide(),d.hide(),a(document).unbind("keydown",c),a(window).unbind("resize",s),a("html").removeClass("lock-scroll")})},preload:function(){var a=this.attr("href");return u=new Image,u.src=a,u.onload=function(){o.galpop("display")},u.onerror=function(){console.log(a+" contains a broken image!")},this},display:function(){var t=u.height,n=u.width,p=o.data("maxWidth"),l=o.data("maxHeight"),d=o.data("maxScreen"),r=a(window).height(),c=a(window).width(),s=0;(!p||p>c*d/100)&&(p=c*d/100),(!l||l>r*d/100)&&(l=r*d/100),n>p&&(s=p/n,t*=s,n*=s),t>l&&(s=l/t,n*=s,t*=s),e.css({height:t,width:n}),setTimeout(function(){o.addClass("complete"),i.append(u).find("img").height(t).width(n).fadeIn(500,"swing",function(){o.galpop("complete")})},500)},complete:function(){var t=o.data("controls"),e=o.data("callback"),n=o.data("index"),i=o.data("count"),p=o.data("loop");o.galpop("infoParse"),!t||0===n&&!p||1>=i?l.hide():l.show(),!t||n+1>=i&&!p||1>=i?d.hide():d.show(),a.isFunction(e)&&e.call(this)},moveItem:function(t){var e=o.data("group");return o.removeClass("complete"),p.fadeOut(500,"swing",function(){a(this).contents().remove()}),i.find("img").fadeOut(500,"swing",function(){a(this).remove(),e.eq(t).galpop("preload"),o.data("index",t)}),this},next:function(){var a=o.data("index"),t=o.data("loop"),e=o.data("count");return e>a+1?(a++,o.galpop("moveItem",a)):t&&(a=0,o.galpop("moveItem",a)),this},prev:function(){var a=o.data("index"),t=o.data("loop"),e=o.data("count");return a>0?(a--,o.galpop("moveItem",a)):t&&(a=e-1,o.galpop("moveItem",a)),this},infoParse:function(){var t=o.data("index"),e=o.data("group"),n=e.eq(t),i=a.trim(n.attr("title")),l=a.trim(n.data("galpop-link")),d=a.trim(n.data("galpop-link-title")),r=a.trim(n.data("galpop-link-target"));p.html(""),""!==i&&a("<p>"+i+"</p>").appendTo(p),""!==l&&(""===d&&(d=l),""!==r&&(r='target="'+r+'"'),a('<p><a href="'+l+'" '+r+">"+d+"</a></p>").appendTo(p)),(""!==i||""!==l)&&p.fadeIn(500,"swing")},update:function(){var a=o.data("index");return o.galpop("moveItem",a),this},destroy:function(){return this.unbind("click")}};a.fn.galpop=function(o){return t[o]?t[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void a.error("Method "+o+" does not exist on jQuery.galpop"):t.init.apply(this,arguments)};var o,e,n,i,p,l,d,r,c,s,u;a(document).ready(function(){o=a('<div id="galpop-wrapper" />').prependTo("body"),e=a('<div id="galpop-container" />').appendTo(o),l=a('<a href="#" id="galpop-prev" />').appendTo(e),d=a('<a href="#" id="galpop-next" />').appendTo(e),n=a('<div id="galpop-ajax" />').appendTo(e),i=a('<div id="galpop-content" />').appendTo(e),p=a('<div id="galpop-info" />').appendTo(i),r=a('<a href="#" id="galpop-close" />').appendTo(i),o.click(function(t){a(this).galpop("closeBox"),t.preventDefault()}),e.click(function(a){a.stopPropagation()}),l.hide().click(function(a){o.galpop("prev"),a.preventDefault()}),d.hide().click(function(a){o.galpop("next"),a.preventDefault()}),r.click(function(a){o.galpop("closeBox"),a.preventDefault()}),p.on("click","a",function(){o.galpop("closeBox")}),c=function(a){var t=a.which;switch(t){case 27:o.galpop("closeBox");break;case 37:o.galpop("prev");break;case 39:o.galpop("next")}a.preventDefault()},s=function(){o.galpop("update")}})}(jQuery);